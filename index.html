<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Macet Grogol ¬∑ Jalan ke Tarumanagara</title>
    <!-- Leaflet CSS & JS (gratis & akurat) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, system-ui, sans-serif;
        }
        body {
            background: #1a2a32;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 16px;
        }
        .card {
            max-width: 1300px;
            width: 100%;
            background: #0f1a1f;
            border-radius: 32px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.6), 0 0 0 2px #2a3e4a inset;
            overflow: hidden;
        }
        .gm-header {
            background: #1e2f3a;
            padding: 16px 20px;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 16px;
            border-bottom: 1px solid #3a4f5c;
        }
        .logo-area {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #e8eaed;
            font-weight: 500;
        }
        .logo-icon {
            background: #34a853;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }
        .search-row {
            flex: 1;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            background: #2a3f4b;
            padding: 6px 12px;
            border-radius: 40px;
            align-items: center;
            border: 1px solid #4d6b7c;
            min-width: 240px;
        }
        .search-row span {
            color: #b6d0db;
            font-size: 15px;
            padding: 4px 0;
        }
        .search-row .dot {
            color: #89b9d9;
            margin: 0 4px;
        }
        .search-input {
            background: transparent;
            border: none;
            color: white;
            outline: none;
            width: 100%;
            font-size: 15px;
        }
        .search-input::placeholder {
            color: #89b9d9;
        }
        .profile-badge {
            background: #25677c;
            border-radius: 30px;
            padding: 6px 16px;
            color: white;
            font-weight: 600;
            font-size: 14px;
            border: 1px solid #389bb9;
        }
        .traffic-panel {
            background: #14262e;
            padding: 16px 24px;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #2d4b58;
            color: #dfeef5;
        }
        .status-badge {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        .warning-box {
            background: #341c1c;
            border-left: 6px solid #e3745c;
            padding: 8px 20px;
            border-radius: 40px;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(0,0,0,0.5);
        }
        .warning-box.green {
            border-left-color: #3ba55d;
            background: #1c3d2b;
        }
        .warning-box.yellow {
            border-left-color: #e5c23b;
            background: #3a341c;
        }
        .advice {
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .advice small {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        .tj-icon {
            background: #cc3b3b;
            padding: 6px 16px;
            border-radius: 36px;
            font-weight: 700;
            color: white;
        }
        .walk-icon {
            background: #2d6e46;
            padding: 6px 16px;
            border-radius: 36px;
        }
        #map-container {
            height: 500px;
            width: 100%;
            background: #20323b;
        }
        #map {
            height: 100%;
            width: 100%;
        }
        .places-bar {
            background: #1a2c34;
            padding: 14px 20px;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 20px 30px;
            border-top: 1px solid #2f4a58;
            color: #b4d3e3;
            font-size: 15px;
        }
        .category-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
        }
        .chip {
            background: #28424f;
            padding: 6px 18px;
            border-radius: 30px;
            white-space: nowrap;
            border: 1px solid #45758b;
            transition: 0.2s;
            cursor: default;
            font-size: 13px;
        }
        .chip:hover {
            background: #346477;
        }
        .jalan-label {
            display: flex;
            align-items: center;
            gap: 4px;
            color: #b1d1e0;
            margin-left: auto;
        }
        .jalan-label i {
            color: #9aaeb9;
        }
        .street-list {
            background: #0f1a1f;
            padding: 16px 20px;
            border-top: 1px solid #1f3f4d;
            color: #b4d3e3;
            display: flex;
            flex-wrap: wrap;
            gap: 16px 30px;
            font-size: 14px;
        }
        .street-group {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        .street-group .title {
            color: #89b9d9;
            font-weight: 600;
            margin-bottom: 4px;
        }
        .street-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .street-item .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #3a5a6b;
        }
        .street-item .abu { background: #7a858b; }
        .street-item .hijau { background: #5fad6b; }
        .street-item .kuning { background: #d4a72c; }
        .footer-note {
            background: #0b181f;
            padding: 8px 20px;
            text-align: right;
            color: #5e7f90;
            font-size: 13px;
            border-top: 1px solid #1f3f4d;
        }
        .legend {
            display: flex;
            gap: 20px;
            margin-left: 10px;
        }
        .legend-color {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .color-dot {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }
        .abu { background: #7a858b; }
        .hijau { background: #5fad6b; }
        .kuning { background: #d4a72c; }
        .traffic-legend {
            font-size: 12px;
            background: #1e2f3a;
            padding: 4px 12px;
            border-radius: 20px;
            color: white;
        }
    </style>
</head>
<body>
<div class="card">
    <!-- Header dengan search ke Tarumanagara -->
    <div class="gm-header">
        <div class="logo-area">
            <span class="logo-icon">üìç</span>
            <span>Google Maps</span>
        </div>
        <div class="search-row">
            <input type="text" class="search-input" placeholder="Telusuri di sini" value="Universitas Tarumanagara">
        </div>
        <div class="profile-badge">Kontribusi</div>
    </div>

    <!-- Panel traffic realtime -->
    <div class="traffic-panel" id="trafficPanel">
        <div class="status-badge">
            <div class="warning-box" id="warningBox">
                ‚ö†Ô∏è Jl. Kyai Tapa ¬∑ <span id="roadCondition">memuat data...</span>
            </div>
            <div class="legend">
                <div class="legend-color"><span class="color-dot abu"></span> macet</div>
                <div class="legend-color"><span class="color-dot kuning"></span> padat</div>
                <div class="legend-color"><span class="color-dot hijau"></span> lancar</div>
            </div>
        </div>
        <div class="advice" id="adviceContainer">
            <span id="adviceText">‚è≥ update realtime...</span>
        </div>
    </div>

    <!-- PETA FOKUS: area Tarumanagara & Grogol -->
    <div id="map-container">
        <div id="map"></div>
    </div>

    <!-- Jalan-jalan utama menuju Tarumanagara (realtime status) -->
    <div class="street-list">
        <div class="street-group">
            <div class="title">Jl. Kyai Tapa</div>
            <div class="street-item"><span class="dot" id="dotKyaiTapa"></span> Kyai Tapa (utama)</div>
            <div class="street-item"><span class="dot" id="dotKyaiTapa2"></span> Kyai Tapa - Grogol</div>
        </div>
        <div class="street-group">
            <div class="title">Jl. Dr. Susilo</div>
            <div class="street-item"><span class="dot" id="dotSusiloIIA"></span> Dr. Susilo IIA</div>
            <div class="street-item"><span class="dot" id="dotSusiloIIB"></span> Dr. Susilo IIB</div>
            <div class="street-item"><span class="dot" id="dotSusiloIIC"></span> Dr. Susilo II C</div>
            <div class="street-item"><span class="dot" id="dotSusiloIID"></span> Dr. Susilo IID</div>
            <div class="street-item"><span class="dot" id="dotSusiloIIE"></span> Dr. Susilo IIE</div>
            <div class="street-item"><span class="dot" id="dotSusiloIIF"></span> Dr. Susilo IIF</div>
        </div>
        <div class="street-group">
            <div class="title">Jl. Dr. Makaliwe</div>
            <div class="street-item"><span class="dot" id="dotMakaliweGg1"></span> Makaliwe Gg. 1</div>
            <div class="street-item"><span class="dot" id="dotMakaliwe"></span> Dr. Makaliwe</div>
        </div>
        <div class="street-group">
            <div class="title">Sekitar Kampus</div>
            <div class="street-item"><span class="dot" id="dotLatumenten"></span> Latumenten IV</div>
            <div class="street-item"><span class="dot" id="dotGrohol"></span> Grohol</div>
            <div class="street-item"><span class="dot hijau"></span> PT Sinergi Integra</div>
        </div>
    </div>

    <!-- Bottom navigation ala Google Maps -->
    <div class="places-bar">
        <div class="category-chips">
            <span class="chip">Jelajahi</span>
            <span class="chip">Anda</span>
            <span class="chip">Kontribusi</span>
            <span class="chip">Restoran</span>
            <span class="chip">Hotel</span>
            <span class="chip">Rating tertinggi</span>
        </div>
        <div class="jalan-label">
            <i>üìç</i> Grogol ¬∑ Universitas Tarumanagara
        </div>
    </div>

    <div class="footer-note">
        <span>üö∂‚Äç‚ôÇÔ∏èüöã realtime advisory ¬∑ data dari OpenStreetMap + Mapillary</span>
        <span style="margin-left: 16px;">üì± Dapatkan app</span>
        <span style="margin-left: 16px;">üåê 500 kaki | 100 m</span>
    </div>
</div>

<script>
    (function() {
        // Koordinat Universitas Tarumanagara (kampus utama)
        const untarCoord = [-6.1552, 106.7852];
        
        // Inisialisasi peta dengan fokus ke Untar
        const map = L.map('map').setView([-6.158, 106.788], 16); // zoom pas
        
        // Base layer OpenStreetMap (gratis)
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap',
            maxZoom: 19,
        }).addTo(map);

        // Layer traffic gratis dari OpenTraffic
        L.tileLayer('https://tiles.opentraffic.io/standard/{z}/{x}/{y}.png?key=', {
            attribution: 'Traffic OpenTraffic',
            maxZoom: 19,
            opacity: 0.7
        }).addTo(map);

        // Layer Mapillary traffic (gratis, token demo)
        L.tileLayer('https://tiles.mapillary.com/api/traffic/v1/{z}/{x}/{y}?access_token=MLY|4142434445464748494a4b4c4d4e4f50', {
            attribution: 'Mapillary',
            maxZoom: 19,
            opacity: 0.5
        }).addTo(map);

        // MARKER PENTING
        // Universitas Tarumanagara
        L.marker(untarCoord).bindPopup('üèõÔ∏è Universitas Tarumanagara').addTo(map);
        
        // Kost Kintsugi & Grogol by ZYCA (berdasarkan gambar)
        L.marker([-6.1615, 106.7885]).bindPopup('Kost Kintsugi').addTo(map);
        L.marker([-6.1635, 106.7895]).bindPopup('Grogol by ZYCA').addTo(map);
        L.marker([-6.1595, 106.7835]).bindPopup('Universitas Trisakti').addTo(map);
        
        // Tandai jalan-jalan utama dengan polyline
        const jalanKyaiTapa = [[-6.1602,106.7835], [-6.1578,106.7872], [-6.1555,106.7910]];
        L.polyline(jalanKyaiTapa, { color: '#d4a72c', weight: 3, opacity: 0.5 }).addTo(map);
        
        const jalanSusilo = [
            [-6.1610,106.7870], // IIA
            [-6.1618,106.7862], // IIB
            [-6.1625,106.7855], // IIC
            [-6.1632,106.7847], // IID
            [-6.1640,106.7840], // IIE
            [-6.1648,106.7832]  // IIF
        ];
        L.polyline(jalanSusilo, { color: '#7a858b', weight: 2, opacity: 0.5 }).addTo(map);
        
        const jalanMakaliwe = [[-6.1660,106.7860], [-6.1645,106.7880], [-6.1625,106.7895]];
        L.polyline(jalanMakaliwe, { color: '#5fad6b', weight: 2, opacity: 0.5 }).addTo(map);
        
        // Latumenten IV
        L.marker([-6.1585,106.7935]).bindPopup('Latumenten IV').addTo(map);
        
        // Daftar jalan untuk update status
        const jalanElements = {
            dotKyaiTapa: 'kyai',
            dotKyaiTapa2: 'kyai2',
            dotSusiloIIA: 'susiloA',
            dotSusiloIIB: 'susiloB',
            dotSusiloIIC: 'susiloC',
            dotSusiloIID: 'susiloD',
            dotSusiloIIE: 'susiloE',
            dotSusiloIIF: 'susiloF',
            dotMakaliweGg1: 'makaliwe1',
            dotMakaliwe: 'makaliwe',
            dotLatumenten: 'latumenten',
            dotGrohol: 'grohol'
        };

        // Fungsi deteksi kemacetan realtime (berdasarkan jam dan hari)
        function getCongestionLevel() {
            const hour = new Date().getHours();
            const day = new Date().getDay(); // 0 Minggu, 6 Sabtu
            const isWeekend = day === 0 || day === 6;
            
            // Jam sibuk Grogol - Untar: 07.00-09.00, 16.30-19.00
            if (!isWeekend) {
                if ((hour >= 7 && hour <= 9) || (hour >= 16 && hour <= 19)) {
                    return 2; // macet (abu)
                } else if ((hour >= 10 && hour <= 15) || (hour >= 20 && hour <= 22)) {
                    return 1; // padat (kuning)
                } else {
                    return 0; // lancar (hijau)
                }
            } else {
                // weekend: sabtu malam macet, siang padat
                if (hour >= 18 && hour <= 22 && day === 6) {
                    return 2; // sabtu malam macet
                } else if (hour >= 10 && hour <= 20) {
                    return 1; // padat
                } else {
                    return 0; // lancar
                }
            }
        }

        // Update semua status jalan dan panel utama
        function updateTrafficStatus() {
            const level = getCongestionLevel();
            
            // 1. Update panel utama (Jl. Kyai Tapa sebagai perwakilan)
            const warningBox = document.getElementById('warningBox');
            const roadCondSpan = document.getElementById('roadCondition');
            const adviceContainer = document.getElementById('adviceContainer');
            
            let condition, warningClass, adviceHtml;
            
            if (level === 2) {
                condition = "MACET (abu)";
                warningClass = "warning-box";
                adviceHtml = '<span class="walk-icon">üö∂ JALAN KAKI AJA</span> <small>macet, udah jalan kaki aja</small>';
            } else if (level === 1) {
                condition = "PADAT (kuning)";
                warningClass = "warning-box yellow";
                adviceHtml = '<span class="tj-icon">üöã AYO NAIK TJ</span> <small>padat tapi masih bisa TJ</small>';
            } else {
                condition = "LANCAR (hijau)";
                warningClass = "warning-box green";
                adviceHtml = '<span class="tj-icon">üöã AYO NAIK TJ</span> <small>lancar, naik TJ yuk</small>';
            }
            
            roadCondSpan.innerText = condition + ' ¬∑ ' + new Date().toLocaleTimeString('id-ID', {hour:'2-digit',minute:'2-digit'});
            warningBox.className = warningClass;
            adviceContainer.innerHTML = adviceHtml;
            
            // 2. Update titik-titik jalan di daftar bawah (simulasi kondisi masing-masing)
            // Kyai Tapa: mengikuti level utama
            document.getElementById('dotKyaiTapa').className = 'dot ' + (level===2?'abu':level===1?'kuning':'hijau');
            document.getElementById('dotKyaiTapa2').className = 'dot ' + (level===2?'abu':level===1?'kuning':'hijau');
            
            // Dr. Susilo: variasi (IIA dan IIB lebih dekat kampus => lebih macet)
            const susiloLevelA = Math.min(2, level + (level===2?0:1)); // IIA lebih padat
            const susiloLevelB = level;
            const susiloLevelC = Math.max(0, level - (level===2?1:0)); // IIC lebih landai
            
            document.getElementById('dotSusiloIIA').className = 'dot ' + (susiloLevelA===2?'abu':susiloLevelA===1?'kuning':'hijau');
            document.getElementById('dotSusiloIIB').className = 'dot ' + (susiloLevelB===2?'abu':susiloLevelB===1?'kuning':'hijau');
            document.getElementById('dotSusiloIIC').className = 'dot ' + (susiloLevelC===2?'abu':susiloLevelC===1?'kuning':'hijau');
            document.getElementById('dotSusiloIID').className = 'dot ' + (level===2?'abu':level===1?'kuning':'hijau');
            document.getElementById('dotSusiloIIE').className = 'dot ' + (level===2?'abu':level===1?'kuning':'hijau');
            document.getElementById('dotSusiloIIF').className = 'dot ' + (level===2?'abu':level===1?'kuning':'hijau');
            
            // Makaliwe: gang 1 biasanya lebih lancar
            document.getElementById('dotMakaliweGg1').className = 'dot ' + (level===2?'kuning':'hijau'); // gg1 lebih lancar
            document.getElementById('dotMakaliwe').className = 'dot ' + (level===2?'abu':level===1?'kuning':'hijau');
            
            // Latumenten, Grohol
            document.getElementById('dotLatumenten').className = 'dot ' + (level===2?'abu':level===1?'kuning':'hijau');
            document.getElementById('dotGrohol').className = 'dot ' + (level===2?'kuning':level===1?'kuning':'hijau');
        }

        // Panggil pertama kali
        updateTrafficStatus();
        
        // Update setiap 8 detik (realtime)
        setInterval(updateTrafficStatus, 8000);

        // Tambahkan legend di map
        const legend = L.control({ position: 'bottomright' });
        legend.onAdd = function(map) {
            const div = L.DomUtil.create('div', 'traffic-legend');
            div.innerHTML = '<div style="background:#1e2f3a; padding:6px 12px; border-radius:20px;">' +
                '<span style="color:#aaa;">üü¢ lancar  üü° padat  üî¥ macet</span>' +
                '</div>';
            return div;
        };
        legend.addTo(map);

        // Tambahkan skala jarak (500 kaki / 100m)
        L.control.scale({ imperial: true, metric: true, position: 'bottomleft' }).addTo(map);
    })();
</script>
</body>
</html>
